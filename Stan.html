<!DOCTYPE html>
<html>
<head>
    <Meta NAME="Title" CONTENT="Stans unglaubliche Websiten">
    <Meta NAME="Author" CONTENT="Der Unglaubliche Stan">
    <Meta NAME="Publisher" CONTENT="Der Unglaubliche Stan">
    <Meta NAME="Keywords" CONTENT="Unglaublich, Suber, Genie, Stan, Unglaublich gute Website, Website">
    <Meta NAME="Description" CONTENT="Stan erstellt unglaubliche Websiten um nicht arbeiten zu mÃ¼ssen">
    <Meta NAME="Robots" CONTENT="DONT INDEX,DONT FOLLOW,DONT UPVOTE,DONT LIKE,STILL PAY ME ALL UR MONEY">
    <Meta NAME="revisit-after" CONTENT="1 Eternity">
    <meta charset="UTF-16"> 
 
    <title>Stans Unglaubliche Websiten</title> 
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="style/stails.css" />
    <link rel="icon" href="icon.ico" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="bootstraphover/bootstrap-hover-dropdown.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <style>
      .affix {
        top: 0;
        width: 100%;
      }

      .affix + .asd{
        padding-top:70px;
      }
    </style>

    </head>
<body>
  <div id="header">
  <a href="Stan.html"> <img src="heada.png" width=100% height=150/> </a>
  </div> <!-- ze header -->

  <nav id="navigator" ng-app="menu" ng-controller="myCtrl" ng-init="init()" class="navbar navbar-default">
    <div class="container-fluid">
     <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#MainMenu">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">Uvod</a>
      </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="MainMenu">
        <ul class="nav navbar-nav">
          <li class="dropdown">
            <a href="#" aria-haspopup="true" aria-expanded="false">Seminare<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="Stan.html">Seminare v nejblizsi dobe</a></li>
              <li><a href="Stan.html">Nahravky a fotografie ze seminaru</a></li>
              <li><a href="Stan.html">Bohemia cantat</a></li>
            </ul>
          </li>
          <li class="dropdown">
            <a href="#" aria-haspopup="true" aria-expanded="false">Kalendare<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="#">Muj kalendar</a></li>
              <li><a href="#">Kalendar Spektra</a></li>
            </ul>
          </li>
          <li class="dropdown">
            <a href="#" aria-haspopup="true" aria-expanded="false">Moje Sbory<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="#">Ayangena</a></li>
              <li><a href="#">Hlahol</a></li>
              <li><a href="#">Spektrum</a></li>
            </ul>
          </li>
          <li class="dropdown">
            <a href="#" aria-haspopup="true" aria-expanded="false">Informace<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="#">Vice o mne</a></li>
              <li><a href="#">O alikvotnim zpivani</a></li>
              <li><a href="#">Sborove skladby Pavla Stanka</a></li>
            </ul>
          </li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><a href="#">Pro pratele</a></li>
        </ul>
      </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
  </nav>         
<div class="container-fluid asd" id="content">
  <form>
    <div class="form-group">
      <label for="title">Titul:</label>
      <input type="text" class="form-control" id="title">
    </div>
    <div class="form-group">
      <label for="content-text">Text:</label>
      <div class="btn-group">
        <button type="button" class="btn btn-default button-sm" id="button-bold" onclick="toggleformatting('<b>','</b>')">B</button>
        <button type="button" class="btn btn-default button-sm" id="button-bold" onclick="fill()">K</button>
        <button type="button" class="btn btn-default button-sm" id="button-bold" onclick="selectText('contenttoedit')">Select</button>
      </div>
      <div class="well" contenteditable="true" style="height:200px" id=contenttoedit></div>
    </div>
  </form>
</div>
<p id="testers">Tester: <br/></p>
<script>
function fill(){$('#contenttoedit').html("Some text, some <b> Bold and <i> cursive</b> text </i> some symbols < and > and / and \"  '  &");}
$('#button-bold').on('click',function(){addformatting(1,2);})


function getPositionWithinHtml(positionWithinText){
var i=0
var j=0
var k=positionWithinText
var text=$('#contenttoedit').html();
//alert(text);
for (i=0;i<k;i++){
  if(text.charAt(j)=='<')
  {
    j=text.indexOf('>',j)+1;
    i--;
  }
  else 
    if (text.charAt(j)=='&')
    {
      if  (text.charAt(j+1)=='a'/*&amp*/)
      {
        j+=5;
      }
      else j+=4;
    }
  else
  {
    j++;
  }

}
return j;
}


function toggleformatting(t1,t2){

  var sel=window.getSelection(),range=window.getSelection().getRangeAt(0).cloneRange(),startpos,endpos,addStart,addEnd;
  $('#testers').html("Tester");
  var text=$('#contenttoedit').html();    //get a copy of the html in the field
  var Range=range.cloneRange();

  var preCaretRange = range.cloneRange();
  preCaretRange.selectNodeContents(document.getElementById("contenttoedit"));    
  preCaretRange.setEnd(range.endContainer, range.endOffset);    
  var caretOffset = preCaretRange.toString().length;   
  endpos=getPositionWithinHtml(caretOffset);    //find the caret (endposition) within the html code
  preCaretRange = range.cloneRange();
  preCaretRange.selectNodeContents(document.getElementById("contenttoedit"));    
  preCaretRange.setEnd(range.startContainer, range.startOffset);    
  caretOffset = preCaretRange.toString().length;
  startpos=getPositionWithinHtml(caretOffset);   //fin the caret (startposition) within the html code

  //now, a bunch of if's comes to do the correct operation
  if (startpos==endpos)
  {
    if (text.lastIndexOf(t1,startpos)>text.lastIndexOf(t2,startpos))//startTag came after endtag: add endtag (f.e. UNbold text)
    {
      $('#contenttoedit').html(text.slice(0,startpos)+t2+text.slice(endpos,text.length))
      addStart=t2.length;
      addEnd=addStart;
    }
    else//set starttage
    {
      $('#contenttoedit').html(text.slice(0,startpos)+t1+text.slice(endpos,text.length))
      addStart=t1.length;
      addEnd=addStart;
    }
  }

  /*else if(){

  }*/
  //$('#contenttoedit').html(text.slice(0,startpos)+t1+text.slice(startpos,endpos)+t2+text.slice(endpos,text.length))
  /*if (document.selection) {
            var range = document.body.createTextRange();
            range.moveToElementText(document.getElementById("contenttoedit"));
            range.select();
        } else if (window.getSelection) {
            var range = document.createRange();
            range.selectNode(document.getElementById("contenttoedit"));
            window.getSelection().addRange(range);
        }*/
        var el = document.getElementById("contenttoedit");
var range = document.createRange();
var sel = window.getSelection();
range.setStart(el.childNodes[2], 5);
range.collapse(true);
sel.removeAllRanges();
sel.addRange(range);
}



  var men= angular.module('menu',[]);
  men.controller('myCtrl', function($scope){
    $scope.act="active"
    $scope.init=function(){
      $scope.act='active'
      $scope.fixxxer='Start'
      $scope.wid=$(window).width();
      $scope.aff=$('#navigator').height();
      $scope.test=""
    }
  })

  var scope =  $('#navigator').scope();

  $(window).on("resize",function(){
    var scope =  $('#navigator').scope();
    scope.$apply(function(){scope.aff=$(window).width();})
    if ($(window).width()<750){
      $(window).off('.affix');
      $("#navigator")
        .removeClass("affix affix-top navbar-fixed-top")
        .removeData("bs.affix")
    }
    else{
      $('#navigator').affix({offset: {top:150}});}
  })

  $(document).ready(function(){
    if ($(window).width()>750){
      $('#navigator').affix({offset: {top:150}});
    }

  $('#navigator').on('affixed.bs.affix', function () {
    var scope =  $('#navigator').scope();
    $('#navigator').addClass("navbar-fixed-top");

    $('#content').css("padding-top",$('#navigator').height()+21);
    scope.$apply(function(){scope.aff=$('#navigator').height();})
  });

  $('#navigator').on('affixed-top.bs.affix', function () {
    var scope =  $('#navigator').scope();
    $('#navigator').removeClass("navbar-fixed-top");
    $('#content').css("padding-top",0);
    scope.$apply(function(){scope.aff="20";})
  });
  });

</script>

</body>
</html>